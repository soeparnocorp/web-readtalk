---
import Layout from '../layouts/BlogPost.astro';
import { getUserData } from '../lib/db'; // fungsi ambil data dari KV / D1
import { Astro } from 'astro';

const username = Astro.params.username || 'readtalk'; // default contoh user
const user = await getUserData(username);

/* Contoh user jika KV kosong */
const defaultUser = {
  displayName: 'ReadTalk Official',
  username: 'readtalk',
  avatar: '/assets/avatar-readtalk.png',
  bio: 'Welcome to ReadTalk â€“ the place to share your thoughts & links!',
  links: [
    { label: 'Twitter', url: 'https://twitter.com/readtalk' },
    { label: 'GitHub', url: 'https://github.com/readtalk' },
    { label: 'Portfolio', url: 'https://readtalk.dev' },
  ],
};

const profile = user || defaultUser;
---

<Layout title={`@${profile.username}`} description={profile.bio}>
  <section style="text-align: center; padding: 2rem;">
    <img
      src={profile.avatar}
      alt={`Avatar of ${profile.displayName}`}
      style="width:100px;height:100px;border-radius:50%;margin-bottom:1rem;"
    />
    <h1>{profile.displayName}</h1>
    <h2 style="color:gray;font-weight:normal">@{profile.username}</h2>
    <p style="max-width:600px;margin:1rem auto;">{profile.bio}</p>

    <div style="margin-top:2rem;display:flex;flex-direction:column;gap:1rem;align-items:center;">
      {profile.links.map(link => (
        <a
          href={link.url}
          target="_blank"
          style="padding:0.8rem 1.5rem;background-color:#4f46e5;color:white;border-radius:12px;text-decoration:none;width:200px;text-align:center;"
        >
          {link.label}
        </a>
      ))}
    </div>
  </section>
</Layout>
